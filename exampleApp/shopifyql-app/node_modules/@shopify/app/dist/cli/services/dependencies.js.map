{"version":3,"file":"dependencies.js","sourceRoot":"","sources":["../../../src/cli/services/dependencies.ts"],"names":[],"mappings":"AAAA,OAAO,EAAM,kBAAkB,EAAC,MAAM,sBAAsB,CAAA;AAC5D,OAAO,EAAC,UAAU,EAAE,EAAE,EAAE,WAAW,EAAC,MAAM,kBAAkB,CAAA;AAE5D;;;;;;GAMG;AACH,MAAM,CAAC,KAAK,UAAU,sBAAsB,CAAC,GAAQ;IACnD,MAAM,IAAI,GAAG,EAAE,CAAC,QAAQ,CACtB;QACE;YACE,KAAK,EAAE,uCAAuC;YAC9C,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE;gBACtB,MAAM,UAAU,CAAC,iCAAiC,CAAC;oBACjD,iBAAiB,EAAE,GAAG,CAAC,iBAAiB;oBACxC,SAAS,EAAE,GAAG,CAAC,SAAS;oBACxB,IAAI,EAAE,CAAC;iBACR,CAAC,CAAA;gBACF,IAAI,CAAC,KAAK,GAAG,wBAAwB,CAAA;YACvC,CAAC;SACF;KACF,EACD,EAAC,cAAc,EAAE,WAAW,CAAC,KAAK,CAAC,UAAU,EAAE,EAAC,CACjD,CAAA;IACD,MAAM,IAAI,CAAC,GAAG,EAAE,CAAA;IAChB,OAAO,kBAAkB,CAAC,GAAG,CAAC,CAAA;AAChC,CAAC","sourcesContent":["import {App, updateDependencies} from '../models/app/app.js'\nimport {dependency, ui, environment} from '@shopify/cli-kit'\n\n/**\n * Given an app, it installs its NPM dependencies by traversing\n * the sub-directories and finding the ones that have NPM dependencies\n * defined in package.json files.\n * @param app {App} App whose dependencies will be installed.\n * @returns {Promise<App>} An copy of the app with the Node dependencies updated.\n */\nexport async function installAppDependencies(app: App) {\n  const list = ui.newListr(\n    [\n      {\n        title: 'Installing any necessary dependencies',\n        task: async (_, task) => {\n          await dependency.installNPMDependenciesRecursively({\n            dependencyManager: app.dependencyManager,\n            directory: app.directory,\n            deep: 3,\n          })\n          task.title = 'Dependencies installed'\n        },\n      },\n    ],\n    {rendererSilent: environment.local.isUnitTest()},\n  )\n  await list.run()\n  return updateDependencies(app)\n}\n"]}